(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{59:function(e,t,n){e.exports=n(89)},89:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(24),l=n.n(c),u=n(19),o=n(8),i=n(108),s=n(109),m=n(110),p=n(107),f=n(2),E=n.n(f),d=n(4),b=n(13),v=n(6),g=n(21),h=n(22),O=n.n(h),y="/api/blogs",j=null,w=function(){var e=Object(d.a)(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.get(y);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=Object(d.a)(E.a.mark((function e(t){var n,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:j}},e.prev=1,e.next=4,O.a.post(y,t,n);case 4:return a=e.sent,e.abrupt("return",a.data);case 8:return e.prev=8,e.t0=e.catch(1),console.log(e.t0.message),e.abrupt("return",e.t0.message);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=Object(d.a)(E.a.mark((function e(t,n){var a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post("".concat(y,"/").concat(t.id,"/comments"),{comment:n});case 3:return a=e.sent,e.abrupt("return",a.data);case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}(),T={getAll:w,setToken:function(e){j="bearer ".concat(e)},createBlog:k,updateLikes:function(){var e=Object(d.a)(E.a.mark((function e(t,n){var a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.put("".concat(y,"/").concat(t),n);case 3:return a=e.sent,e.abrupt("return",a.data);case 7:return e.prev=7,e.t0=e.catch(0),console.log(e.t0.message),e.abrupt("return",e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}(),deleteBlog:function(){var e=Object(d.a)(E.a.mark((function e(t){var n,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:j}},e.prev=1,e.next=4,O.a.delete("".concat(y,"/").concat(t),n);case 4:return a=e.sent,e.abrupt("return",a.status);case 8:return e.prev=8,e.t0=e.catch(1),console.log(e.t0.message),e.abrupt("return",e.t0.message);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),commentBlog:x},B=function(e){return function(){var t=Object(d.a)(E.a.mark((function t(n){return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,T.deleteBlog(e);case 2:if(204===t.sent){t.next=5;break}return t.abrupt("return");case 5:n({type:"DELETE_BLOG",data:e});case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},S=function(e){return function(){var t=Object(d.a)(E.a.mark((function t(n){var a;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,T.updateLikes(e.id,e);case 2:a=t.sent,n({type:"LIKE_BLOG",data:a});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_BlOGS":return Object(g.a)(t.data);case"CREATE_BLOG":return[].concat(Object(g.a)(e),[t.data]);case"DELETE_BLOG":return e.filter((function(e){return e.id!==t.data}));case"LIKE_BLOG":case"UPDATE_COMMENTS":return e.map((function(e){return e.id!==t.data.id?e:t.data}));default:return e}},C=function(e){var t=Object(a.useState)(!1),n=Object(b.a)(t,2),c=n[0],l=n[1],u=Object(v.b)(),o=function(){var e=Object(d.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u(S(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i=function(){var e=Object(d.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u(B(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"showFullBlog",onClick:function(){l(!c)}},"View"),c?r.a.createElement("div",{className:"TestBlogFullBlog"},r.a.createElement("p",null,r.a.createElement("em",null,"Title: "),e.blog.title),r.a.createElement("p",null,r.a.createElement("em",null,"Author: ")," ",e.blog.author),r.a.createElement("p",null,"Likes: ",e.blog.likes," ",r.a.createElement("button",{className:"TestLikeButton",onClick:function(){return o(e.blog)}},"Like")),r.a.createElement("p",null,"URL: ",e.blog.url),r.a.createElement("button",{onClick:function(){i(e.blog.id)}},"delete blog (above)")):r.a.createElement("div",{className:"TestBlogBlurb"},r.a.createElement("p",null,r.a.createElement("em",null,"Title:"),e.blog.title,r.a.createElement("em",null," Author:")," ",e.blog.author)))},A=n(111),U=function(e){var t=Object(v.c)((function(e){return e}));return t.notification.show?r.a.createElement(A.a,null,t.notification.message):null},_=r.a.forwardRef((function(e,t){var n=Object(a.useState)(!1),c=Object(b.a)(n,2),l=c[0],u=c[1],o={display:l?"none":""},i={display:l?"":"none"},s=function(){u(!l)};return Object(a.useImperativeHandle)(t,(function(){return{handleVisibility:s}})),r.a.createElement("div",null,r.a.createElement("div",{style:o},r.a.createElement("button",{onClick:s},e.name)," "),r.a.createElement("div",{style:i,className:"TestTogglable"},r.a.createElement("button",{onClick:s},e.name," (hide)"),e.children))}));_.displayName="Togglable";var R,N=_,G=function(e){var t=e.visibility,n=Object(a.useState)(""),c=Object(b.a)(n,2),l=c[0],u=c[1],o=Object(a.useState)(""),i=Object(b.a)(o,2),s=i[0],m=i[1],p=Object(a.useState)(""),f=Object(b.a)(p,2),g=f[0],h=f[1],O=Object(v.b)();return r.a.createElement("div",null,r.a.createElement("h2",null,"Add a Blog"),r.a.createElement("form",{className:"TestAddBlog",onSubmit:function(e){var n;e.preventDefault(),t(),O((n={title:l,author:s,url:g},function(){var e=Object(d.a)(E.a.mark((function e(t){var a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.createBlog(n);case 2:a=e.sent,t({type:"CREATE_BLOG",data:a});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),u(""),m(""),h("")}},r.a.createElement("p",null,r.a.createElement("label",null,"Title: "),r.a.createElement("input",{type:"text",value:l,onChange:function(e){return u(e.target.value)},id:"title"})),r.a.createElement("p",null,r.a.createElement("label",null,"Author: "),r.a.createElement("input",{type:"text",value:s,onChange:function(e){return m(e.target.value)},id:"author",required:!0})),r.a.createElement("p",null,r.a.createElement("label",null,"URL: "),r.a.createElement("input",{type:"text",value:g,onChange:function(e){return h(e.target.value)},id:"url",required:!0})),r.a.createElement("button",{type:"submit"},"Create")))},I=n(50),D={userLogin:function(){var e=Object(d.a)(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post("/api/login",t);case 3:return n=e.sent,e.abrupt("return",n.data);case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},M=function(e){return function(){var t=Object(d.a)(E.a.mark((function t(n){var a;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,D.userLogin(e);case 3:(a=t.sent)&&T.setToken(a.token),n({type:"SET_USER",data:a}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()},F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return Object(I.a)({},t.data);case"REMOVE_USER":return{};default:return e}},V=function(e){return function(){var t=Object(d.a)(E.a.mark((function t(n){return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"SET_NOTICE",data:e}),clearTimeout(R),R=setTimeout((function(){n({type:"CLEAR"})}),2e3);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NOTICE":return{show:!0,message:t.data.message};case"CLEAR":return{};default:return e}},P=function(){var e=Object(a.useState)(""),t=Object(b.a)(e,2),n=t[0],c=t[1],l=Object(a.useState)(""),u=Object(b.a)(l,2),o=u[0],i=u[1],s=Object(v.b)(),m=Object(v.c)((function(e){return e}));Object(a.useEffect)((function(){m.client.name&&window.localStorage.setItem("loggedInUser",JSON.stringify(m.client))}),[m.client]);var f=function(){var e=Object(d.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault();try{s(M({username:n,password:o})),s(V({message:"".concat(n," was logged in")})),c(""),i("")}catch(a){console.log(a)}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return m.client.name?r.a.createElement("div",null,r.a.createElement("p",null,m.client.name," is logged in.",r.a.createElement(p.a,{id:"logoutButton",onClick:function(){window.localStorage.removeItem("loggedInUser"),s(function(){var e=Object(d.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"REMOVE_USER"});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),T.setToken(null)}},"logout"))):r.a.createElement("form",{onSubmit:function(e){return f(e,n,o)}},r.a.createElement("h2",null,"Login"),r.a.createElement("p",null,r.a.createElement("label",null,"username: "),r.a.createElement("input",{type:"text",value:n,onChange:function(e){return c(e.target.value)},id:"loginUsername"})),r.a.createElement("p",null,r.a.createElement("label",null,"password: "),r.a.createElement("input",{type:"password",value:o,onChange:function(e){return i(e.target.value)},id:"loginPassword"})),r.a.createElement(p.a,{variant:"contained",color:"primary",id:"loginButton",type:"submit"},"login"))},H=function(){return r.a.createElement("center",null,r.a.createElement("br",null),r.a.createElement("p",null,r.a.createElement("strong",null,r.a.createElement("em",null,"University of Helsinki, FULLSTACK OPEN - 2020"))))},K={getAll:function(){var e=Object(d.a)(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.get("/api/users");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},q=function(){return function(){var e=Object(d.a)(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K.getAll();case 2:n=e.sent,t({type:"GET_ALL",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_ALL":return Object(g.a)(t.data);default:return e}},W=function(){var e=Object(v.b)(),t=Object(v.c)((function(e){return e}));return Object(a.useEffect)((function(){e(q())}),[t.blogs,e]),r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Users"),r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"name"),r.a.createElement("th",null,"Blogs"))),r.a.createElement("tbody",null,t.users.map((function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement("th",null,r.a.createElement(u.b,{to:"/users/".concat(e.id)},e.name)),r.a.createElement("th",null,e.blogs.length))})))))},Y=function(){var e=Object(v.c)((function(e){return e})),t=Object(o.f)("/users/:id"),n=t?e.users.find((function(e){return e.id===t.params.id})):null;return n?r.a.createElement("div",null,r.a.createElement("h3",null,n.name.toUpperCase()),r.a.createElement("h3",null,"Blogs"),r.a.createElement("ul",null,n.blogs.map((function(e){return r.a.createElement("li",{key:e.id},e.title)})))):null},Q=function(){var e=Object(v.c)((function(e){return e}));return r.a.createElement("div",null,r.a.createElement("h2",null,"Blogs"),r.a.createElement("hr",null),e.blogs.map((function(e){return r.a.createElement("div",{key:e.id},r.a.createElement("h4",null,r.a.createElement(u.b,{to:"/blogs/".concat(e.id)},e.title," BY ",e.author)),r.a.createElement("p",null,"uploaded by ",e.user.name),r.a.createElement("hr",null))})))},X=function(){var e=Object(a.useState)(""),t=Object(b.a)(e,2),n=t[0],c=t[1],l=Object(v.c)((function(e){return e})),u=Object(v.b)(),i=Object(o.f)("/blogs/:id"),s=i?l.blogs.find((function(e){return e.id===i.params.id})):null;return s?r.a.createElement("div",null,r.a.createElement("h2",null,s.title," by ",s.author),"URL: ",r.a.createElement("a",{href:s.url},s.url),r.a.createElement("p",null,s.likes," Likes"," ",r.a.createElement("button",{onClick:function(){return u(S(s))}},"Like")),r.a.createElement("p",null,"added by: ",s.user.name),r.a.createElement("h4",null,"Comments"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),console.log(n),u(function(e,t){return function(){var n=Object(d.a)(E.a.mark((function n(a){var r;return E.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,T.commentBlog(e,t);case 2:r=n.sent,console.log("action",r),a({type:"UPDATE_COMMENTS",data:r});case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}(s,n)),c("")}},r.a.createElement("input",{type:"text",value:n,onChange:function(e){c(e.target.value)}}),r.a.createElement("button",{type:"submit"},"Add comment")),r.a.createElement("ul",null,s.comments.map((function(e,t){return r.a.createElement("li",{key:t},e)})))):null},Z=n(51),$=n.n(Z),ee=function(){var e=Object(v.b)(),t=Object(a.useRef)(),n=Object(v.c)((function(e){return e})),c=n.client.name;Object(a.useEffect)((function(){e(function(){var e=Object(d.a)(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.getAll();case 2:n=e.sent,t({type:"GET_BlOGS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e(q())}),[e]),Object(a.useEffect)((function(){var t,n=window.localStorage.getItem("loggedInUser");if(n){var a=JSON.parse(n);e((t=a,function(){var e=Object(d.a)(E.a.mark((function e(n){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n({type:"SET_USER",data:t});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))}else console.log("useEffect: empty local storage")}),[e]);var l={color:"white",textDecoration:"none"};return r.a.createElement(i.a,null,r.a.createElement(s.a,{position:"static"},r.a.createElement(m.a,null,r.a.createElement(p.a,{variant:"outlined",color:"primary"},r.a.createElement(u.b,{style:l,to:"/"},r.a.createElement("p",{style:l},"Home"))),r.a.createElement(p.a,{color:"primary"},r.a.createElement(u.b,{style:l,to:"/users"},r.a.createElement("p",{style:l},"Users"))),r.a.createElement(p.a,{color:"primary"},r.a.createElement(u.b,{style:l,to:"/blogs"},r.a.createElement("p",{style:l},"Blogs"))))),r.a.createElement(U,null),r.a.createElement("br",null),r.a.createElement(P,null),r.a.createElement(o.c,null,r.a.createElement(o.a,{path:"/users/:id"},r.a.createElement(Y,null)),r.a.createElement(o.a,{path:"/users"},r.a.createElement(W,null)),r.a.createElement(o.a,{path:"/blogs/:id"},r.a.createElement(X,null)),r.a.createElement(o.a,{path:"/blogs"},r.a.createElement(Q,null)),r.a.createElement(o.a,{path:"/"},c&&r.a.createElement(N,{name:"Add New Blog",ref:t},r.a.createElement(G,{visibility:function(){t.current.handleVisibility()}})),r.a.createElement("h2",null,"Blogs"),$.a.orderBy(n.blogs,["likes"],["desc"]).map((function(e){return r.a.createElement(C,{key:e.id,blog:e})})))),r.a.createElement(H,null))},te=n(26),ne=n(52),ae=n(53),re=Object(te.combineReducers)({blogs:L,client:F,users:z,notification:J}),ce=Object(te.createStore)(re,Object(ne.composeWithDevTools)(Object(te.applyMiddleware)(ae.a)));l.a.render(r.a.createElement(v.a,{store:ce},r.a.createElement(u.a,null,r.a.createElement(ee,null))),document.getElementById("root"))}},[[59,1,2]]]);
//# sourceMappingURL=main.f6529d7c.chunk.js.map